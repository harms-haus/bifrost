{{if .Error}}
<div class="page-header">
  <h1>Account Not Found</h1>
</div>
<div class="card">
  <div class="card-body">
    <p class="text-muted">{{.Error}}</p>
    <a href="/admin/accounts" class="btn btn-primary">Back to Accounts</a>
  </div>
</div>
{{else}}
<div class="page-header">
  <h1>PATs for {{.Data.Account.Username}}</h1>
  <p class="text-muted">{{.Data.Account.AccountID}}</p>
</div>

<div class="card">
  <div class="card-header">
    <h2>Create New PAT</h2>
  </div>
  <div class="card-body">
    <form method="post" action="/admin/accounts/{{.Data.AccountID}}/pats" hx-post="/admin/accounts/{{.Data.AccountID}}/pats" hx-target="closest .card-body" class="form-inline">
      <input type="hidden" name="action" value="create">
      <div class="form-group">
        <label for="label">Label:</label>
        <input type="text" name="label" id="label" placeholder="e.g., CLI, CI/CD" class="form-control">
      </div>
      <button type="submit" class="btn btn-primary">Create PAT</button>
    </form>
  </div>
</div>

<div class="card">
  <div class="card-header">
    <h2>PATs ({{len .Data.PATs}})</h2>
  </div>
  <div class="card-body">
    {{if .Data.PATs}}
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Label</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {{range .Data.PATs}}
        <tr>
          <td><code>{{.PATID}}</code></td>
          <td>{{.Label}}</td>
          <td>
            {{if .Revoked}}
            <span class="badge badge-suspended">Revoked</span>
            {{else}}
            <span class="badge badge-active">Active</span>
            {{end}}
          </td>
          <td>
            {{if not .Revoked}}
            <form method="post" action="/admin/accounts/{{$.Data.AccountID}}/pats" class="form-inline" style="display:inline">
              <input type="hidden" name="action" value="revoke">
              <input type="hidden" name="pat_id" value="{{.PATID}}">
              <button type="submit" class="btn btn-danger btn-sm">Revoke</button>
            </form>
            {{end}}
          </td>
        </tr>
        {{end}}
      </tbody>
    </table>
    {{else}}
    <p class="text-muted">No PATs found for this account</p>
    {{end}}
  </div>
</div>

<div class="page-actions">
  <a href="/admin/accounts/{{.Data.AccountID}}" class="btn btn-secondary">Back to Account</a>
  <a href="/admin/accounts" class="btn btn-secondary">All Accounts</a>
</div>
{{end}}
